<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./css/style.css">
  <link href='https://fonts.googleapis.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
</head>

<body>


  <main>
    <figure>
      <picture>
        <source media="(min-width: 768px)" srcset="//my-assets.netlify.com/codepen/dailyui-001/img.png     340w,
                              //my-assets.netlify.com/codepen/dailyui-001/img@2x.png  680w,
                              //my-assets.netlify.com/codepen/dailyui-001/img@3x.png 1020w" sizes="360px" />
        <source srcset="//my-assets.netlify.com/codepen/dailyui-001/img-small.png     340w,
                              //my-assets.netlify.com/codepen/dailyui-001/img-small@2x.png  680w,
                              //my-assets.netlify.com/codepen/dailyui-001/img-small@3x.png 1020w" sizes="(min-width: 320px) 290px,
                              (min-width: 480px) 435px
                              (min-width: 640px) 580px" />
        <img src="//my-assets.netlify.com/codepen/dailyui-001/img.png" alt="Citymap illustration" />
      </picture>
    </figure>
    <div class="headline">
      <h2 class="text-headline">Rio Casa</h2>
      <h3 class="text-subheadline">Wayanad</h2>
    </div>
    <form action="rio_casa.html" method="get">
      <span>
        <label for="name" class="text-small-uppercase">Name</label>
        <input class="text-body" id="name" name="name" type="text" required>
      </span>
      <span>
        <label for="name" class="text-small-uppercase">Contact</label>
        <input class="text-body" id="contact" name="contact" type="text" required>
      </span>
      <span>
        <label for="amount" class="text-small-uppercase">Advance</label>
        <input class="text-body" id="amount" name="amount" type="text" required>
      </span>
      <span>
        <label for="balance" class="text-small-uppercase">Balance</label>
        <input class="text-body" id="balance" name="balance" type="text" required>
      </span>
      <div class="dates">
        <span class="date">
          <label for="balance" class="text-small-uppercase">Check In</label>
          <input class="text-body" id="checkin" name="checkin" type="date" required>
        </span>
        <span class="date">
          <label for="balance" class="text-small-uppercase">Check Out</label>
          <input class="text-body" id="checkout" name="checkout" type="date" required>
        </span>
      </div>
      <input type="hidden" id="referenceNumber" name="referenceNumber">
      <input class="text-small-uppercase" id="submit" type="submit" value="Generate">
    </form>
  </main>

  <script>
    var inputs = document.querySelectorAll('input[type=text], input[type=email]');
    for (i = 0; i < inputs.length; i++) {
      var inputEl = inputs[i];
      if (inputEl.value.trim() !== '') {
        inputEl.parentNode.classList.add('input--filled');
      }
      inputEl.addEventListener('focus', onFocus);
      inputEl.addEventListener('blur', onBlur);
    }

    function onFocus(ev) {
      ev.target.parentNode.classList.add('inputs--filled');
    }

    function onBlur(ev) {
      if (ev.target.value.trim() === '') {
        ev.target.parentNode.classList.remove('inputs--filled');
      } else if (ev.target.checkValidity() == false) {
        ev.target.parentNode.classList.add('inputs--invalid');
        ev.target.addEventListener('input', liveValidation);
      } else if (ev.target.checkValidity() == true) {
        ev.target.parentNode.classList.remove('inputs--invalid');
        ev.target.addEventListener('input', liveValidation);
      }
    }

    function liveValidation(ev) {
      if (ev.target.checkValidity() == false) {
        ev.target.parentNode.classList.add('inputs--invalid');
      } else {
        ev.target.parentNode.classList.remove('inputs--invalid');
      }
    }

    var submitBtn = document.querySelector('input[type=submit]');
    submitBtn.addEventListener('click', onSubmit);

    function onSubmit(ev) {
      var inputsWrappers = ev.target.parentNode.querySelectorAll('span');
      for (i = 0; i < inputsWrappers.length; i++) {
        input = inputsWrappers[i].querySelector('input[type=text], input[type=email]');
        if (input.checkValidity() == false) {
          inputsWrappers[i].classList.add('inputs--invalid');
        } else if (input.checkValidity() == true) {
          inputsWrappers[i].classList.remove('inputs--invalid');
        }
      }
    }
    // Generate random reference number
    function generateReferenceNumber() {
      const prefix = 'RIOCSA';
      const length = 12 - prefix.length;
      let referenceNumber = prefix;

      while (referenceNumber.length < 12) {
        referenceNumber += Math.random().toString(36).substring(2, 3);
      }

      return referenceNumber.toUpperCase();
    }

    // Set the value of the hidden input field
    document.getElementById('referenceNumber').value = generateReferenceNumber();
  </script>
</body>

</html>